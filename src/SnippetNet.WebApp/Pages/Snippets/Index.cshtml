@page
@model SnippetNet.WebApp.Pages.Snippets.IndexModel
@{
	ViewData["Title"] = "Snippets";
}
<div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between gap-3 mb-4">
    <div>
        <h1 class="display-6 fw-semibold mb-2">Your snippet library</h1>
        <p class="muted-text mb-0">Organise, search and maintain your reusable code blocks in one beautiful workspace.</p>
    </div>
    <div class="d-flex gap-2">
        <a class="btn btn-outline-secondary" asp-page="/Index">
            <i class="bi bi-house me-2"></i>
            Back to home
        </a>
        <a class="btn btn-primary" asp-page="Create" style="color:#564eb4">
            <i class="bi bi-plus-circle me-2"></i>
            New snippet
        </a>
    </div>
</div>
@if (!string.IsNullOrWhiteSpace(Model.SuccessMessage))
{
    <div class="alert alert-success shadow-sm">@Model.SuccessMessage</div>
}

@if (Model.Snippets is null || Model.Snippets.Count == 0)
{
    <div class="empty-state">
        <i class="bi bi-inboxes"></i>
        <h2 class="h4">No snippets yet</h2>
        <p class="mb-4">Start building your personal snippet hub by capturing your first code example.</p>
        <a class="btn btn-primary" asp-page="Create">
            <i class="bi bi-plus-lg me-2"></i>
            Add snippet
        </a>
    </div>
}
else
{
    <div class="glass-card p-3 p-lg-4 mb-4">
        <div class="row g-3 align-items-center">
            <div class="col-lg-8">
                <label for="snippetSearch" class="form-label mb-1">Search your collection</label>
                <div class="position-relative">
                    <i class="bi bi-search position-absolute top-50 start-0 translate-middle-y ms-3 text-white-50"></i>
                    <input id="snippetSearch"
                           type="search"
                           class="form-control form-control-lg ps-5"
                           placeholder="Search by title, description, language or tag"
                           data-snippet-search />
                </div>
            </div>
            <div class="col-lg-4 text-lg-end">
                <span class="muted-text small">@Model.Snippets.Count snippet@(Model.Snippets.Count == 1 ? string.Empty : "s") available</span>
            </div>
        </div>
    </div>

    <div class="snippet-grid" data-snippet-grid>
        @foreach (var snippet in Model.Snippets)
        {
            <article class="card p-4 shadow-sm h-100" data-snippet-item data-search-text="@string.Join(" ", new[] { snippet.Title, snippet.Description, snippet.Language, snippet.TagName })">
                <div class="d-flex align-items-center justify-content-between gap-2 mb-3">
                    <span class="badge badge-soft px-3 py-2 text-uppercase small">@snippet.Language</span>
                    <span class="muted-text small d-inline-flex align-items-center gap-1">
                        <i class="bi bi-tag"></i>
                        @snippet.TagName
                    </span>
                </div>
                <h2 class="h4 card-title mb-2">@snippet.Title</h2>
                <div class="snippet-meta mb-4">
                    <span class="d-inline-flex align-items-center gap-2">
                        <i class="bi bi-code-square text-white-50"></i>
                        <span>Language: <strong>@snippet.Language</strong></span>
                    </span>
                    <span class="d-inline-flex align-items-center gap-2">
                        <i class="bi bi-hash text-white-50"></i>
                        <span>Tag: <strong>@snippet.TagName</strong></span>
                    </span>
                </div>
                <div class="snippet-actions d-flex flex-wrap gap-2">
                    <a asp-page="Details" asp-route-id="@snippet.Id" class="btn btn-sm btn-primary">
                        <i class="bi bi-eye me-1"></i>
                        View details
                    </a>
                    <a asp-page="Edit" asp-route-id="@snippet.Id" class="btn btn-sm btn-secondary">
                        <i class="bi bi-pencil-square me-1"></i>
                        Edit
                    </a>
                    <a asp-page="Delete" asp-route-id="@snippet.Id" class="btn btn-sm btn-danger">
                        <i class="bi bi-trash me-1"></i>
                        Delete
                    </a>
                </div>
            </article>
        }
    </div>

    <div class="text-center muted-text mt-4" data-snippet-empty>
        <i class="bi bi-search"></i>
        <p class="mb-0">No snippets match your search just yet.</p>
    </div>
}
