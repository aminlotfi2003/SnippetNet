@page "{id:guid}"
@model SnippetNet.WebApp.Pages.Snippets.DetailsModel
@{
    ViewData["Title"] = "Snippet Details";
}
<h1>Snippet Details</h1>

@if (Model.Snippet is null)
{
    <div class="alert alert-danger">Snippet not found.</div>
}
else
{
    var snippet = Model.Snippet;

    <dl class="row">
        <dt class="col-sm-2">Title</dt>
        <dd class="col-sm-10">@snippet.Title</dd>
        <dt class="col-sm-2">Language</dt>
        <dd class="col-sm-10">@snippet.Language</dd>
        <dt class="col-sm-2">Tag Name</dt>
        <dd class="col-sm-10">@snippet.TagName</dd>
        <dt class="col-sm-2">Description</dt>
        <dd class="col-sm-10">@snippet.Description</dd>
    </dl>

    <!-- Code Block -->
    <div class="code-container position-relative mb-3">
        <button type="button" class="btn btn-sm btn-outline-light copy-btn" onclick="copyToClipboard()">
            <i class="bi bi-clipboard"></i> Copy
        </button>
        <pre id="snippetCode"><code class="language-@snippet.Language.ToLower()">@snippet.Code</code></pre>
    </div>

    <!-- Action Buttons -->
    <div class="mt-3 d-flex gap-2">
        <a asp-page="Edit" asp-route-id="@snippet.Id" class="btn btn-primary">Edit</a>
        <a asp-page="Delete" asp-route-id="@snippet.Id" class="btn btn-outline-danger">Delete</a>
        <a asp-page="Index" class="btn btn-secondary">Back</a>
    </div>
}

@section Scripts {
    <script>
        function copyToClipboard() {
            const codeElement = document.getElementById("snippetCode");
            const text = codeElement.innerText.trim();
            navigator.clipboard.writeText(text).then(() => {
                const toast = document.createElement("div");
                toast.classList.add("copied-toast");
                toast.textContent = "Copied!";
                const container = document.querySelector(".code-container");
                container.appendChild(toast);
                setTimeout(() => toast.remove(), 1500);
            });
        }
    </script>
}
